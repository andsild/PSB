<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8" />
<title>A Really Friendly Guide To Wavelets | PolyValens</title>
<link rel="profile" href="http://gmpg.org/xfn/11" />
<link rel="stylesheet" type="text/css" media="all" href="http://www.polyvalens.com/blog/wp-content/themes/weaver/style.css" />
<link rel="pingback" href="http://www.polyvalens.com/blog/xmlrpc.php" />
<link rel="alternate" type="application/rss+xml" title="PolyValens &raquo; Feed" href="http://www.polyvalens.com/blog/feed/" />
<link rel="alternate" type="application/rss+xml" title="PolyValens &raquo; Comments Feed" href="http://www.polyvalens.com/blog/comments/feed/" />
<link rel='stylesheet' id='weaver-style-sheet-css'  href='http://www.polyvalens.com/blog/wp-content/uploads/weaver-subthemes/style-weaver.css?ver=2' type='text/css' media='all' />
<link rel='stylesheet' id='MWM-AAL-FRONT-CSS-css'  href='http://www.polyvalens.com/blog/wp-content/plugins/better-anchor-links/css/mwm-aal.css?ver=1.2.0' type='text/css' media='screen' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.polyvalens.com/blog/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.polyvalens.com/blog/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='EZW Encoding' href='http://www.polyvalens.com/blog/wavelets/ezw/' />
<link rel='next' title='Electronics' href='http://www.polyvalens.com/blog/electronics/' />

<link rel='canonical' href='http://www.polyvalens.com/blog/wavelets/theory/' />
<link rel='shortlink' href='http://www.polyvalens.com/blog/?p=15' />

<!-- This site is using Weaver 2.2.9 subtheme: IndieAve -->
<meta name="description" content=" PolyValens - Stuff about things about stuff " />
<meta name="keywords" content="PolyValens blog, PolyValens" />
<!-- Add your own CSS snippets between the style tags. -->
<style type="text/css">
</style>
<!--[if lte IE 7]>
<style type="text/css" media="screen">
div.menu { display:inline !important;}
.menu-add, .menu-add-left {margin-top:-4px !important;}
</style>
<![endif]-->
<!--[if lte IE 8]>
<style type="text/css" media="screen">
#primary, #secondary, #altleft, #altright, #ttw-top-widget, #ttw-bot-widget,
  #ttw-site-top-widget, #ttw-site-bot-widget, #per-page-widget, #wrapper {
  behavior: url(http://www.polyvalens.com/blog/wp-content/themes/weaver/js/PIE/PIE.php); position:relative; }
</style>
<![endif]-->

<!-- End of Weaver options -->
<script type="text/javascript">
(function(url){
if(/(?:Chrome\/26\.0\.1410\.63 Safari\/537\.31|WordfenceTestMonBot)/.test(navigator.userAgent)){ return; }
var wfscr = document.createElement('script');
wfscr.type = 'text/javascript';
wfscr.async = true;
wfscr.src = url + '&r=' + Math.random();
(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(wfscr);
})('//www.polyvalens.com/blog/wp-admin/admin-ajax.php?action=wordfence_logHuman&hid=FC20793E71363C5807DFE0F446D60B60'); 
</script></head>

<body class="page page-id-15 page-child parent-pageid-5 page-template page-template-page-altright-php">
<div id="wrapper" class="hfeed">
    <div id="header">
    	<div id="masthead">
		<div id="ttw-site-logo"></div>
		<div id="ttw-site-logo-link" onclick="location.href='http://www.polyvalens.com/blog/';" style="cursor:pointer;"></div>
		<div id="site-title" style="display:none;">
		    <span>
			<a href="http://www.polyvalens.com/blog/" title="PolyValens" rel="home">PolyValens</a>
		    </span>
		</div>
		<div id="site-description" style="display:none;">Stuff about things about stuff</div>
		<div class="skip-link screen-reader-text"><a href="#content" title="Skip to content">Skip to content</a></div>

	    <div id="branding" role="banner">
		    <a href="http://www.polyvalens.com/blog/" title="PolyValens" rel="home">
			<img src="http://www.polyvalens.com/blog/wp-content/uploads/2011/09/cropped-hdr9_2.jpg" width="940" height="99" alt="PolyValens" />
</a>
	    </div><!-- #branding -->
	    		<div id="nav-bottom-menu"><div id="access" role="navigation">
<div class="menu"><ul><li class="page_item page-item-167"><a href="http://www.polyvalens.com/blog/">Home</a></li><li class="page_item page-item-5 page_item_has_children current_page_ancestor current_page_parent"><a href="http://www.polyvalens.com/blog/wavelets/">Wavelets</a><ul class='children'><li class="page_item page-item-15 current_page_item"><a href="http://www.polyvalens.com/blog/wavelets/theory/">A Really Friendly Guide To Wavelets</a></li><li class="page_item page-item-11"><a href="http://www.polyvalens.com/blog/wavelets/fast-lifting-wavelet-transform/">The Fast Lifting Wavelet Transform</a></li><li class="page_item page-item-13"><a href="http://www.polyvalens.com/blog/wavelets/ezw/">EZW Encoding</a></li></ul></li><li class="page_item page-item-7"><a href="http://www.polyvalens.com/blog/vl-1/">Casio VL-Tone Emulator</a></li><li class="page_item page-item-120 page_item_has_children"><a href="http://www.polyvalens.com/blog/electronics/">Electronics</a><ul class='children'><li class="page_item page-item-522"><a href="http://www.polyvalens.com/blog/electronics/elektor-articles/">Elektor articles</a></li><li class="page_item page-item-540"><a href="http://www.polyvalens.com/blog/electronics/circuit-cellar-articles/">Circuit Cellar articles</a></li><li class="page_item page-item-518"><a href="http://www.polyvalens.com/blog/electronics/sceptre/">Sceptre &#8211; a 32-bit ARM7 fast prototyping system</a></li><li class="page_item page-item-616"><a href="http://www.polyvalens.com/book" target="_blank">Book: Mastering Microcontrollers, Helped by Arduino</a></li><li class="page_item page-item-679"><a href="http://www.polyvalens.com/blog/electronics/multi-purpose-pwm-wave-shaper/">Multi-purpose PWM Wave Shaper</a></li><li class="page_item page-item-586"><a href="http://www.polyvalens.com/enervuino">Livre: Maîtrisez les microcontrôleurs à l&#8217;aide d&#8217;Arduino</a></li></ul></li></ul></div>
		</div></div><!-- #access -->
		
	</div><!-- #masthead -->
    </div><!-- #header -->


    <div id="main">
    <div class="right-alt">
      	<div id="container" class="wvr-altright">
	<div id="content">
	    <div id="post-15" class="post-15 page type-page status-publish hentry">
<h1 class="entry-title"  >A Really Friendly Guide To Wavelets</h1>
		    <div class="entry-content">
<p><a href="http://www.polyvalens.com/blog/?page_id=11" title="The Fast Lifting Wavelet Transform">The Fast Lifting Wavelet Transform</a><br />
<a href="http://www.polyvalens.com/blog/?page_id=13" title="EZW Encoding">EZW Encoding</a></p>
<p><a name="disclaimer"></a><H2>Disclaimer</H2></p>
<p>This tutorial is aimed at the engineer, not the mathematician. This does not mean that there will be no mathematics; it just means that there will be no proofs in the text. In my humble opinion, mathematical papers are completely unreadable because of the proofs that clutter the text. For proofs the reader is pointed to suitable references. The equations presented are there to illustrate and to clarify things, I hope. It should not be necessary to understand all the equations in order to understand the theory. However, to understand this tutorial, a mathematical background on an engineering level is required. Also some knowledge of signal processing theory might come in handy.</p>
<p>The information presented in this tutorial is believed to be correct. However, no responsibility whatsoever will be accepted for any damage whatsoever due to errors or misleading statements or whatsoever in this tutorial. Should there be anything incorrect, incomplete or not clear in this text, please let me know so that I can improve this tutorial.</p>
<p><a name="section1"></a><a name="1-introduction"></a><H2>1. Introduction</H2></p>
<p>It is well known from Fourier theory that a signal can be expressed as the sum of a, possibly infinite, series of sines and cosines. This sum is also referred to as a Fourier expansion. However, the big disadvantage of a Fourier expansion is that it has only frequency resolution and no time resolution. This means that although we might be able to determine all the frequencies present in a signal, we do not know at what time they are present. To overcome this problem in the past decades several solutions have been developed which are more or less able to represent a signal in the time and frequency domain at the same time.</p>
<p>The idea behind these time-frequency joint representations is to cut the signal of interest into several parts and then analyze the parts separately. It is clear that analyzing a signal this way will give more information about the when and where of different frequency components, but it leads to a fundamental problem as well: how to cut the signal? Suppose that we want to know exactly all the frequency components present at a certain moment in time. We cut out only this very short time window using a Kronecker delta <a href="#note2">[2]</a>, transform it to the frequency domain and &#8230; something is very wrong.</p>
<p>The problem here is that cutting the signal corresponds to a convolution between the signal and the cutting window. Since convolution in the time domain is identical to multiplication in the frequency domain and since the Fourier transform of a Kronecker delta contains all possible frequencies the frequency components of the signal will be smeared out all over the frequency axis. (Please note that we are talking about a two-dimensional time-frequency transform and not a one-dimensional transform.) In fact this situation is the opposite of the standard Fourier transform since we now have time resolution but no frequency resolution whatsoever.</p>
<p>The underlying principle of the phenomena just described is due to Heisenberg&#8217;s uncertainty principle, which, in signal processing terms, states that it is impossible to know the exact frequency and the exact time of occurrence of this frequency in a signal. In other words, a signal can simply not be represented as a point in the time-frequency space. The uncertainty principle shows that it is very important how one cuts the signal.</p>
<p>The <em>wavelet transform</em> or <em>wavelet analysis</em> is probably the most recent solution to overcome the shortcomings of the Fourier transform. In wavelet analysis the use of a fully scalable modulated window solves the signal-cutting problem. The window is shifted along the signal and for every position the spectrum is calculated. Then this process is repeated many times with a slightly shorter (or longer) window for every new cycle. In the end the result will be a collection of time-frequency representations of the signal, all with different resolutions. Because of this collection of representations we can speak of a multiresolution analysis. In the case of wavelets we normally do not speak about time-frequency representations but about time-scale representations, scale being in a way the opposite of frequency, because the term frequency is reserved for the Fourier transform.</p>
<p>Since from literature it is not always clear what is meant by small and large scales, I will define it here as follows: the large scale is the big picture, while the small scales show the details. Thus, going from large scale to small scale is in this context equal to zooming in.</p>
<p>In the following sections I will present the wavelet transform and develop a scheme that will allow us to implement the wavelet transform in an efficient way on a digital computer. The transform will be so efficient that it does not even use wavelets anymore. (The careful reader might raise an eyebrow here and ask: &#8220;<em>Surely you can&#8217;t be serious?</em>&#8220;) <a href="#note3">[3]</a></p>
<p>But before we continue a disclaimer. Since wavelet theory is not a new thing anymore, it has been around now for fifteen years, say, I will not present a full and in-depth theory here. Several good textbooks on wavelet theory are available and many readable papers with a good review of wavelet theory have been published. The list of references at the end of this tutorial contains pointers to texts with more extensive wavelet theory coverage like (in no particular order) <a href="#kai94">[Kai94]</a>, <a href="#wei94">[Wei94]</a>, <a href="#she96">[She96]</a>, <a href="#bur98">[Bur98]</a>, <a href="#dau92">[Dau92]</a>, <a href="#hub96">[Hub96]</a>, <a href="#mal89">[Mal89]</a>, <a href="#vet92">[Vet92]</a>. I do however present some mathematical background in order to tell a coherent and clear tale (I hope).</p>
<p>Having this said, let&#8217;s go on to the wavelets.</p>
<p><a name="section2"></a><a name="2-the-continuous-wavelet-transform"></a><H2>2. The continuous wavelet transform</H2></p>
<p>The wavelet analysis described in the introduction is known as the <em>continuous wavelet transform</em> or <em>CWT</em>. More formally it is written as:</p>
<p><a name="eq1"></a><img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_983.5_db4a65d2c0c6708f7d1fc6ce0df24b20.png" style="vertical-align:-16.5px; display: inline-block ;" alt="gamma(s,tau)=int{}{}{f(t) psi {conjug} _{s,tau}(t)} dt" title="gamma(s,tau)=int{}{}{f(t) psi {conjug} _{s,tau}(t)} dt"/> <strong>(1)</strong></p>
<p>where <img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_992.5_6d2a5439a7026bf882de710c001a7082.png" style="vertical-align:-7.5px; display: inline-block ;" alt="conjug" title="conjug"/> denotes complex conjugation. This equation shows how a function <img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_991.5_e98953251f4e0ef4d46316adf5f8241b.png" style="vertical-align:-8.5px; display: inline-block ;" alt="f(t)" title="f(t)"/> is decomposed into a set of basis functions</p>
<p><img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_984.5_28134103ac1369c10f2785ee746a9e1b.png" style="vertical-align:-15.5px; display: inline-block ;" alt="psi_{s,tau}(t)" title="psi_{s,tau}(t)"/></p>
<p>called the wavelets. The variables <img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_993_df512b9cb3e7d8de7206c647590b6de0.png" style="vertical-align:-7px; display: inline-block ;" alt="s" title="s"/> and <img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_993_c69b4b157707ebd6fc9a52cc750ee8f9.png" style="vertical-align:-7px; display: inline-block ;" alt="tau" title="tau"/>, scale and translation, are the new dimensions after the wavelet transform. For completeness sake <a href="#eq2">(2)</a> gives the inverse wavelet transform. I will not expand on this since we are not going to use it:</p>
<p><a name="eq2"></a><img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_985_35af40ee2002bfd06121f6e06dfdcb29.png" style="vertical-align:-15px; display: inline-block ;" alt="f(t)=doubleint{}{}{gamma(s,t) psi_{s,tau}(t)} d tau ds" title="f(t)=doubleint{}{}{gamma(s,t) psi_{s,tau}(t)} d tau ds"/> <strong>(2)</strong></p>
<p>The wavelets are generated from a single basic wavelet <img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_990.5_73e91bee8903aca48c2a51e78c7e8d6e.png" style="vertical-align:-9.5px; display: inline-block ;" alt="psi (t)" title="psi (t)"/>, the so-called <em>mother wavelet</em>, by scaling and translation:</p>
<p><a name="eq3"></a><img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_976.5_be1c3401887b6a7f2140de799a69b4ab.png" style="vertical-align:-23.5px; display: inline-block ;" alt="psi_{s,tau}(t) = {1/sqrt{s}}psi({t-tau}/s)" title="psi_{s,tau}(t) = {1/sqrt{s}}psi({t-tau}/s)"/> <strong>(3)</strong></p>
<p>In <a href="#eq3">(3)</a> <em>s</em> is the scale factor, <img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_993_c69b4b157707ebd6fc9a52cc750ee8f9.png" style="vertical-align:-7px; display: inline-block ;" alt="tau" title="tau"/> is the translation factor and the factor <em>s</em><sup>-1/2</sup> is for energy normalization across the different scales.</p>
<p>It is important to note that in <a href="#eq1">(1)</a>, <a href="#eq2">(2)</a> and <a href="#eq3">(3)</a> the wavelet basis functions are not specified. This is a difference between the wavelet transform and the Fourier transform, or other transforms. The theory of wavelet transforms deals with the general properties of the wavelets and wavelet transforms only. It defines a framework within one can design wavelets to taste and wishes.</p>
<p><a name="section3"></a><a name="3-wavelet-properties"></a><H2>3. Wavelet properties</H2></p>
<p>The most important properties of wavelets are the admissibility and the regularity conditions and these are the properties which gave wavelets their name. It can be shown <a href="#she96">[She96]</a> that square integrable functions <img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_990.5_124d1a2aa39a734d5490409b97abfb31.png" style="vertical-align:-9.5px; display: inline-block ;" alt="psi(t)" title="psi(t)"/> satisfying the <em>admissibility condition</em>,</p>
<p><a name="eq4"></a><img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_970_2a618fabac772a3e267711bb2767fa15.png" style="vertical-align:-30px; display: inline-block ;" alt="int{}{}{ delim{|}{Psi(omega)}{|}^2/delim{|}omega{|}}d omega < +infty" title="int{}{}{ delim{|}{Psi(omega)}{|}^2/delim{|}omega{|}}d omega < +infty"/> <strong>(4)</strong></p>
<p>can be used to first analyze and then reconstruct a signal without loss of information. In <a href="#eq4">(4)</a></p>
<p><img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_990.5_e83c05d1936569e5aa862b6c9f08e93f.png" style="vertical-align:-9.5px; display: inline-block ;" alt="Psi(omega)" title="Psi(omega)"/> stands for the Fourier transform of <img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_990.5_124d1a2aa39a734d5490409b97abfb31.png" style="vertical-align:-9.5px; display: inline-block ;" alt="psi(t)" title="psi(t)"/>. The admissibility condition implies that the Fourier transform of <img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_990.5_124d1a2aa39a734d5490409b97abfb31.png" style="vertical-align:-9.5px; display: inline-block ;" alt="psi(t)" title="psi(t)"/> vanishes at the zero frequency, i.e.</p>
<p><a name="eq5"></a><img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_981.5_0a623cc104fb18cd99b7664d906e3624.png" style="vertical-align:-18.5px; display: inline-block ;" alt="delim{|}{Psi(omega)}{|}^2 _{omega=0} = 0" title="delim{|}{Psi(omega)}{|}^2 _{omega=0} = 0"/> <strong>(5)</strong></p>
<p>This means that wavelets must have a band-pass like spectrum. This is a very important observation, which we will use later on to build an efficient wavelet transform.</p>
<p>A zero at the zero frequency also means that the average value of the wavelet in the time domain must be zero,</p>
<p><a name="eq6"></a><img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_987.5_8b3687221b97dd1b639ade0df8e202ab.png" style="vertical-align:-12.5px; display: inline-block ;" alt="int{}{}{psi(t)}dt = 0" title="int{}{}{psi(t)}dt = 0"/> <strong>(6)</strong></p>
<p>and therefore it must be oscillatory. In other words, <img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_990.5_124d1a2aa39a734d5490409b97abfb31.png" style="vertical-align:-9.5px; display: inline-block ;" alt="psi(t)" title="psi(t)"/> must be a <em>wave</em>.</p>
<p>As can be seen from <a href="#eq1">(1)</a> the wavelet transform of a one-dimensional function is two-dimensional; the wavelet transform of a two-dimensional function is four-dimensional. The time-bandwidth product of the wavelet transform is the square of the input signal and for most practical applications this is not a desirable property. Therefore one imposes some additional conditions on the wavelet functions in order to make the wavelet transform decrease quickly with decreasing scale <em>s</em>. These are the <em>regularity conditions</em> and they state that the wavelet function should have some smoothness and concentration in both time and frequency domains. Regularity is a quite complex concept and we will try to explain it a little using the concept of <em>vanishing moments</em>.</p>
<p>If we expand the wavelet transform <a href="#eq1">(1)</a> into the Taylor series at <em>t</em> = 0 until order n (let <img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_993_202cd9117ff9f2cfa2508bada3ca5379.png" style="vertical-align:-7px; display: inline-block ;" alt="tau = 0" title="tau = 0"/> for simplicity) we get <a href="#she96">[She96]</a>:</p>
<p><a name="eq7"></a><img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_953_8254da2adabc44716dc3532500859e3c.png" style="vertical-align:-47px; display: inline-block ;" alt="gamma(s,0) = {1/sqrt{s}} delim{[}{sum{p=0}{n}{ f^p(0) int{}{}{{t^p}/{p!}psi(t/s)}dt } + O(n+1)} {]}" title="gamma(s,0) = {1/sqrt{s}} delim{[}{sum{p=0}{n}{ f^p(0) int{}{}{{t^p}/{p!}psi(t/s)}dt } + O(n+1)} {]}"/> <strong>(7)</strong></p>
<p>Here <em>f</em> <sup>(<em>p</em>)</sup> stands for the <em>p<sup>th</sup></em> derivative of <em>f</em> and <em>O</em>(<em>n</em>+1) means the rest of the expansion. Now, if we define the <em>moments</em> of the wavelet by <em>M<sub>p</sub></em>,</p>
<p><a name="eq8"></a><img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_980.5_974d028b39f134e91ac9158220e6514c.png" style="vertical-align:-19.5px; display: inline-block ;" alt="M _{(p)}=int{}{}{t^p psi(t)}dt" title="M _{(p)}=int{}{}{t^p psi(t)}dt"/> <strong>(8)</strong></p>
<p>then we can rewrite <a href="#eq7">(7)</a> into the finite development</p>
<p><a name="eq9"></a><img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_972_2bba75f926bb9109df0523d27209622a.png" style="vertical-align:-28px; display: inline-block ;" alt="gamma(s,0)={1/sqrt{s}} delim {[}{ f(0)M _0 s + {f^{(1)}(0)}/{1!} M _1 s^2 + {f^{(2)}(0)}/{2!} M _2 s^3 + cdots + {f^{(n)}(0)}/{n!} M _n s^{n+1} + O(s^{n+2})} {]}" title="gamma(s,0)={1/sqrt{s}} delim {[}{ f(0)M _0 s + {f^{(1)}(0)}/{1!} M _1 s^2 + {f^{(2)}(0)}/{2!} M _2 s^3 + cdots + {f^{(n)}(0)}/{n!} M _n s^{n+1} + O(s^{n+2})} {]}"/> <strong>(9)</strong></p>
<p>From the admissibility condition we already have that the 0<sup>th</sup> moment <em>M</em><sub>0</sub> = 0 so that the first term in the right-hand side of <a href="#eq9">(9)</a> is zero. If we now manage to make the other moments up to <em>M<sub>n</sub></em> zero as well, then the wavelet transform coefficients <img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_990.5_de797f7ed65415971da94a303ad49128.png" style="vertical-align:-9.5px; display: inline-block ;" alt="gamma(s,tau)" title="gamma(s,tau)"/> will decay as fast as <em>s<sup>n</sup></em>+2 for a smooth signal <em>f</em>(<em>t</em>). This is known in literature as the <em>vanishing moments</em> <a href="#note4">[4]</a> or <em>approximation order</em>. If a wavelet has <em>N</em> vanishing moments, then the approximation order of the wavelet transform is also <em>N</em>. The moments do not have to be exactly zero, a small value is often good enough. In fact, experimental research suggests that the number of vanishing moments required depends heavily on the application <a href="#cal96">[Cal96]</a>.</p>
<p>Summarizing, the admissibility condition gave us the wave, regularity and vanishing moments gave us the fast decay or the <em>let</em>, and put together they give us the wavelet. More about regularity <a href="#note5">[5]</a> can be found for instance in <a href="#bur98">[Bur98]</a> and <a href="#dau92">[Dau92]</a>.</p>
<p><a name="section4"></a><a name="4-discrete-wavelets"></a><H2>4. Discrete wavelets</H2></p>
<p>Now that we know what the wavelet transform is, we would like to make it practical. However, the wavelet transform as described so far still has three properties that make it difficult to use directly in the form of <a href="#eq1">(1)</a>. The first is the redundancy of the CWT. In <a href="#eq1">(1)</a> the wavelet transform is calculated by continuously shifting a continuously scalable function over a signal and calculating the correlation between the two. It will be clear that these scaled functions will be nowhere near an orthogonal basis <a href="#note6">[6]</a> and the obtained wavelet coefficients will therefore be highly redundant. For most practical applications we would like to remove this redundancy.</p>
<p>Even without the redundancy of the CWT we still have an infinite number of wavelets in the wavelet transform and we would like to see this number reduced to a more manageable count. This is the second problem we have.</p>
<p>The third problem is that for most functions the wavelet transforms have no analytical solutions and they can be calculated only numerically or by an optical analog computer. Fast algorithms are needed to be able to exploit the power of the wavelet transform and it is in fact the existence of these fast algorithms that have put wavelet transforms where they are today.</p>
<p>Let us start with the removal of redundancy.</p>
<p>As mentioned before the CWT maps a one-dimensional signal to a two-dimensional time-scale joint representation that is highly redundant. The time-bandwidth product of the CWT is the square of that of the signal and for most applications, which seek a signal description with as few components as possible, this is not efficient. To overcome this problem <em>discrete wavelets</em> have been introduced. Discrete wavelets are not continuously scalable and translatable but can only be scaled and translated in discrete steps. This is achieved by modifying the wavelet representation <a href="#eq3">(3)</a> to create <a href="#dau92">[Dau92]</a></p>
<p><a name="eq10"></a><img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_959_922ad2adf10a2c0a26ba9e9d7a2ddbc0.png" style="vertical-align:-41px; display: inline-block ;" alt="psi _{j,k} (t) = {1/sqrt{s ^j _0}} psi ((t-k tau _0 s ^j _0}/{s ^j _0})" title="psi _{j,k} (t) = {1/sqrt{s ^j _0}} psi ((t-k tau _0 s ^j _0}/{s ^j _0})"/> <strong>(10)</strong></p>
<p>Although it is called a discrete wavelet, it normally is a (piecewise) continuous function. In <a href="#eq10">(10)</a> <em>j</em> and <em>k</em> are integers and <em>s</em><sub>0</sub> &gt; 1 is a fixed dilation step. The translation factor <img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_984_cbafcc4ecd130d48f4e4921a298679d1.png" style="vertical-align:-16px; display: inline-block ;" alt="tau _0" title="tau _0"/> depends on the dilation step. The effect of making the wavelet discrete is that the time-scale space is now sampled at discrete intervals. We usually choose <em>s</em><sub>0</sub> = 2 so that the sampling of the frequency axis corresponds to <em>dyadic sampling</em>. This is a very natural choice for computers, the human ear and music for instance. For the translation factor we usually choose <img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_984_8b7096f379621d3975c33771e7ec03f4.png" style="vertical-align:-16px; display: inline-block ;" alt="tau _0 = 1" title="tau _0 = 1"/> so that we also have dyadic sampling of the time axis.</p>
<p><a name="fig1"></a><div id="attachment_301" style="width: 360px" class="wp-caption alignnone"><img src="http://www.polyvalens.com/blog/wp-content/uploads/2011/07/fig3-1-gray.png" alt="dots on a dyadic grid" title="fig3-1 gray" width="350" height="197" class="size-full wp-image-301" /><p class="wp-caption-text">Figure 1. Localization of the discrete wavelets in the time-scale space on a dyadic grid.</p></div></p>
<p>When discrete wavelets are used to transform a continuous signal the result will be a series of wavelet coefficients, and it is referred to as the <em>wavelet series decomposition</em>. An important issue in such a decomposition scheme is of course the question of reconstruction. It is all very well to sample the time-scale joint representation on a dyadic grid, but if it will not be possible to reconstruct the signal it will not be of great use. As it turns out, it is indeed possible to reconstruct a signal from its wavelet series decomposition. In <a href="#dau92">[Dau92]</a> it is proven that the necessary and sufficient condition for stable reconstruction is that the energy of the wavelet coefficients must lie between two positive bounds, i.e.</p>
<p><a name="eq11"></a><img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_948.5_b0b5d615d9d34659f2e6a66152d20f18.png" style="vertical-align:-51.5px; display: inline-block ;" alt="A delim{vert}{x}{vert} ^2 <= sum {j,k}{}{delim{|}{ linprod f,psi _{j,k} rinprod}{|}^2} <= B delim{vert}{x}{vert} ^2" title="A delim{vert}{x}{vert} ^2 <= sum {j,k}{}{delim{|}{ linprod f,psi _{j,k} rinprod}{|}^2} <= B delim{vert}{x}{vert} ^2"/> <strong>(11)</strong></p>
<p>where || <em>f</em> ||<sup>2</sup> is the energy of <em>f</em>(<em>t</em>), <em>A</em> &gt; 0, <em>B</em> &lt; <img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_992.5_0ecc917fe107f0c9c44dccd347683354.png" style="vertical-align:-7.5px; display: inline-block ;" alt="infty" title="infty"/> and <em>A</em>, <em>B</em> are independent of <em>f</em>(<em>t</em>). When <a href="#eq11">(11)</a> is satisfied, the family of basis functions <img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_984.5_454dea7287e6b5d1a9cd802730a2419d.png" style="vertical-align:-15.5px; display: inline-block ;" alt="psi _{j,k} (t)" title="psi _{j,k} (t)"/> with <img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_992.5_3c1225536ac4bddb8bdc923f5aef7173.png" style="vertical-align:-7.5px; display: inline-block ;" alt="j, k ~ in ~ bbZ" title="j, k ~ in ~ bbZ"/> is referred to as a <em>frame</em> with frame bounds <em>A</em> and <em>B</em>. When <em>A</em> = <em>B</em> the frame is <em>tight</em> and the discrete wavelets behave exactly like an orthonormal basis. When <em>A</em> <img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_992.5_42722ba05186cf30924d59f07a6d1f6b.png" style="vertical-align:-7.5px; display: inline-block ;" alt="ne" title="ne"/> <em>B</em> exact reconstruction is still possible at the expense of a <em>dual frame</em>. In a dual frame discrete wavelet transform the decomposition wavelet is different from the reconstruction wavelet.</p>
<p>We will now immediately forget the frames and continue with the removal of all redundancy from the wavelet transform. The last step we have to take is making the discrete wavelets orthonormal. This can be done only with discrete wavelets. The discrete wavelets can be made orthogonal to their own dilations and translations by special choices of the mother wavelet, which means:</p>
<p><a name="eq12"></a><img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_966_14dbecbe257bcc6875d5b6da24b0b1d0.png" style="vertical-align:-34px; display: inline-block ;" alt="int{}{}{psi _{j,k}(t) psi conjug _{m,n}(t) }dt = lbrace matrix{2}{1}{{1 ~ if ~ j=m ~ and ~ k=n} {0 ~ otherwise}}" title="int{}{}{psi _{j,k}(t) psi conjug _{m,n}(t) }dt = lbrace matrix{2}{1}{{1 ~ if ~ j=m ~ and ~ k=n} {0 ~ otherwise}}"/> <strong>(12)</strong></p>
<p>An arbitrary signal can be reconstructed by summing the orthogonal wavelet basis functions, weighted by the wavelet transform coefficients <a href="#she96">[She96]</a>:</p>
<p><a name="eq13"></a><img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_972_ab2fb27ae9ea0156c773020efc4765d2.png" style="vertical-align:-28px; display: inline-block ;" alt="f(t) = sum {j,k} {} {gamma (j,k) psi _{j,k}(t) }" title="f(t) = sum {j,k} {} {gamma (j,k) psi _{j,k}(t) }"/> <strong>(13)</strong></p>
<p><a href="#eq13">(13)</a> shows the inverse wavelet transform for discrete wavelets, which we had not yet seen.</p>
<p>Orthogonality is not essential in the representation of signals. The wavelets need not be orthogonal and in some applications the redundancy can help to reduce the sensitivity to noise <a href="#she96">[She96]</a> or improve the <em>shift invariance</em> of the transform <a href="#bur98">[Bur98]</a> because the discrete wavelet transform is not shift invariant, which means that the wavelet transforms of a signal and of a time-shifted version of the same signal are not simply shifted versions of each other. </p>
<p><a name="section5"></a><a name="5-a-band-pass-filter"></a><H2>5. A band-pass filter</H2></p>
<p>With the redundancy removed, we still have two hurdles to take before we have the wavelet transform in a practical form. We continue by trying to reduce the number of wavelets needed in the wavelet transform and save the problem of the difficult analytical solutions for the end.</p>
<p>Even with discrete wavelets we still need an infinite number of scalings and translations to calculate the wavelet transform. The easiest way to tackle this problem is simply not to use an infinite number of discrete wavelets. Of course this poses the question of the quality of the transform. Is it possible to reduce the number of wavelets to analyze a signal and still have a useful result?</p>
<p>The translations of the wavelets are of course limited by the duration of the signal under investigation so that we have an upper boundary for the wavelets. This leaves us with the question of dilation: how many scales do we need to analyze our signal? How do we get a lower bound? It turns out that we can answer this question by looking at the wavelet transform in a different way.</p>
<p>If we look at <a href="#eq5">(5)</a> we see that the wavelet has a band-pass like spectrum. From Fourier theory we know that compression in time is equivalent to stretching the spectrum and shifting it upwards:</p>
<p><a name="eq14"></a><img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_979.5_b458a62927d1bd301e4c1ab90a20c57d.png" style="vertical-align:-20.5px; display: inline-block ;" alt="F delim{lbrace}{f(at)}{rbrace}= 1/{delim{|}{a}{|}}F(omega/a)" title="F delim{lbrace}{f(at)}{rbrace}= 1/{delim{|}{a}{|}}F(omega/a)"/> <strong>(14)</strong></p>
<p>This means that a time compression of the wavelet by a factor of two will stretch the frequency spectrum of the wavelet by a factor of two and also shift all frequency components up by a factor of two. Using this insight we can cover the finite spectrum of our signal with the spectra of dilated wavelets in the same way as that we covered our signal in the time domain with translated wavelets. To get a good coverage of the signal spectrum the stretched wavelet spectra should touch each other, as if they were standing hand in hand (see <a href="#fig2">figure 2</a>). This can be arranged by correctly designing the wavelets.</p>
<p><a name="fig2"></a><div id="attachment_304" style="width: 459px" class="wp-caption alignnone"><img src="http://www.polyvalens.com/blog/wp-content/uploads/2011/07/fig3-2-gray.png" alt="stretching spectra to the right" title="fig3-2 gray" width="449" height="77" class="size-full wp-image-304" /><p class="wp-caption-text">Figure 2. Touching wavelet spectra resulting from scaling of the mother wavelet in the time domain.</p></div></p>
<p>Summarizing: if one wavelet can be seen as a band-pass filter, then a series of dilated wavelets can be seen as a band-pass filter bank. If we look at the ratio between the center frequency of a wavelet spectrum and the width of this spectrum we will see that it is the same for all wavelets. This ratio is normally referred to as the fidelity factor Q of a filter and in the case of wavelets one speaks therefore of a <em>constant-Q</em> filter bank.</p>
<p><a name="section6"></a><a name="6-intermezzo-a-constraint"></a><H2>6. Intermezzo: a constraint</H2></p>
<p>As an intermezzo we will now take a look at an important constraint on our signal, which has sneaked in during the last section: the signal to analyze must have finite energy. When the signal has infinite energy it will be impossible to cover its frequency spectrum and its time duration with wavelets. Usually this constraint is formally stated as</p>
<p><a name="eq15"></a><img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_964.5_667640b6309d1975adde2512a0d9f574.png" style="vertical-align:-35.5px; display: inline-block ;" alt="int {0}{infty}{delim{|}{f(t)}{|} ^2 dt} < infty" title="int {0}{infty}{delim{|}{f(t)}{|} ^2 dt} < infty"/> <strong>(15)</strong></p>
<p>and it is equivalent to saying that the L<sup>2</sup>-norm of our signal <em>f</em>(<em>t</em>) should be finite. This is where Hilbert spaces come in so we quickly end our intermezzo and only memorize that natural signals normally have finite energy.</p>
<p><a name="section7"></a><a name="7-the-scaling-function-7"></a><H2>7. The scaling function <a href="#note7"><font size=2>[7]</font></a></H2> </p>
<p>The careful reader will now ask him- or herself the question how to cover the spectrum all the way down to zero? Because every time you stretch the wavelet in the time domain with a factor of two, its bandwidth is halved. In other words, with every wavelet stretch you cover only half of the remaining spectrum, which means that you will need an infinite number of wavelets to get the job done <a href="#note8">[8]</a>.</p>
<p>The solution to this problem is simply not to try to cover the spectrum all the way down to zero with wavelet spectra, but to use a cork to plug the hole when it is small enough. This cork then is a low-pass spectrum and it belongs to the so-called <em>scaling function</em>. The scaling function was introduced by Mallat <a href="#mal89">[Mal89]</a>. Because of the low-pass nature of the scaling function spectrum it is sometimes referred to as the <em>averaging filter</em>.</p>
<p>If we look at the scaling function as being just a signal with a low-pass spectrum, then we can decompose it in wavelet components and express it in a way similar to <a href="#eq13">(13)</a>:</p>
<p><a name="eq16"></a><img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_972_9ec71024938c3100c3946f87fb9e4af1.png" style="vertical-align:-28px; display: inline-block ;" alt="varphi(t) = sum {j,k} {} {gamma (j,k) psi _{j,k}(t) }" title="varphi(t) = sum {j,k} {} {gamma (j,k) psi _{j,k}(t) }"/> <strong>(16)</strong></p>
<p>Since we selected the scaling function <img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_990.5_401c297d966e5b81d9c660a3ac0f1144.png" style="vertical-align:-9.5px; display: inline-block ;" alt="varphi(t)" title="varphi(t)"/> in such a way that its spectrum neatly fitted in the space left open by the wavelets, the expression <a href="#eq16">(16)</a> uses an infinite number of wavelets up to a certain scale <em>j</em> (see <a href="#fig3">figure 3</a>). This means that if we analyze a signal using the combination of scaling function and wavelets, the scaling function by itself takes care of the spectrum otherwise covered by all the wavelets up to scale <em>j</em>, while the rest is done by the wavelets. In this way we have limited the number of wavelets from an infinite number to a finite number.</p>
<p><a name="fig3"></a><div id="attachment_316" style="width: 463px" class="wp-caption alignnone"><img src="http://www.polyvalens.com/blog/wp-content/uploads/2011/07/fig3-3-gray1.png" alt="band-pass spectra replaced by low-pass spectrum" title="fig3-3 gray" width="453" height="150" class="size-full wp-image-316" /><p class="wp-caption-text">Figure 3. How an infinite set of wavelets is replaced by one scaling function.</p></div></p>
<p>By introducing the scaling function we have circumvented the problem of the infinite number of wavelets and set a lower bound for the wavelets. Of course when we use a scaling function instead of wavelets we lose information. That is to say, from a signal representation point of view we do not loose any information, since it will still be possible to reconstruct the original signal, but from a wavelet-analysis point of view we discard possible valuable scale information. The width of the scaling function spectrum is therefore an important parameter in the wavelet transform design. The shorter its spectrum the more wavelet coefficients you will have and the more scale information. But, as always, there will be practical limitations on the number of wavelet coefficients you can handle. As we will see later on, in the discrete wavelet transform this problem is more or less automatically solved.</p>
<p>The low-pass spectrum of the scaling function allows us to state some sort of admissibility condition similar to <a href="#eq6">(6)</a>:</p>
<p><a name="eq17"></a><img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_987.5_a4b2554398bddc1716d7dde277f5c3e5.png" style="vertical-align:-12.5px; display: inline-block ;" alt="int {}{}{varphi(t)}dt = 1" title="int {}{}{varphi(t)}dt = 1"/> <strong>(17)</strong></p>
<p>which shows that the 0<sup>th</sup> moment of the scaling function can not vanish <a href="#note9">[9]</a>.</p>
<p>Summarizing once more, if one wavelet can be seen as a band-pass filter and a scaling function is a low-pass filter, then a series of dilated wavelets together with a scaling function can be seen as a filter bank.</p>
<p><a name="section8"></a><a name="8-subband-coding"></a><H2>8. Subband coding</H2></p>
<p>Two of the three problems mentioned in <a name="section4">section 4</a> have now been resolved, but we still do not know how to calculate the wavelet transform. Therefore we will continue our journey through multiresolution land.</p>
<p>If we regard the wavelet transform as a filter bank, we can consider wavelet transforming a signal as passing the signal through this filter bank. The outputs of the different filter stages are the wavelet- and scaling function transform coefficients. Analyzing a signal by passing it through a filter bank is not a new idea and has been around for many years under the name <em>subband coding</em>. It is used for instance in computer vision applications.</p>
<p><a name="fig4"></a><div id="attachment_318" style="width: 544px" class="wp-caption alignnone"><img src="http://www.polyvalens.com/blog/wp-content/uploads/2011/07/fig3-4_2-gray1.png" alt="recursively splitted spectra and a filter tree" title="fig3-4_2 gray" width="534" height="375" class="size-full wp-image-318" /><p class="wp-caption-text">Figure 4. Splitting the signal spectrum with an iterated filter bank.</p></div></p>
<p>The filter bank needed in subband coding can be built in several ways. One way is to build many band-pass filters to split the spectrum into frequency bands. The advantage is that the width of every band can be chosen freely, in such a way that the spectrum of the signal to analyze is covered in the places where it might be interesting. The disadvantage is that we will have to design every filter separately and this can be a time consuming process. Another way is to split the signal spectrum in two (equal) parts, a low-pass and a high-pass part. The high-pass part contains the smallest details we are interested in and we could stop here. We now have two bands. However, the low-pass part still contains some details and therefore we can split it again. And again and again, until we are satisfied with the number of bands we have created. In this way we have created an <em>iterated filter bank</em>. Usually the number of bands is limited by for instance the amount of data or computation power available. The process of splitting the spectrum is graphically displayed in <a href="#fig4">figure 4</a>. The advantage of this scheme is that we have to design only two filters; the disadvantage is that the signal spectrum coverage is fixed.</p>
<p>Looking at <a href="#fig4">figure 4</a> we see that what we are left with after the repeated spectrum splitting is a series of band-pass bands with doubling bandwidth and one low-pass band. (Although in theory the first split gave us a high-pass band and a low-pass band, in reality the high-pass band is a band-pass band due to the limited bandwidth of the signal.) In other words, we can perform the same subband analysis by feeding the signal into a bank of band-pass filters of which each filter has a bandwidth twice as wide as his left neighbor (the frequency axis runs to the right here) and a low-pass filter. At the beginning of this section we stated that this is the same as applying a wavelet transform to the signal. The wavelets give us the band-pass bands with doubling bandwidth and the scaling function provides us with the low-pass band. From this we can conclude that a wavelet transform is the same thing as a subband coding scheme using a constant-Q filter bank <a href="#note10">[10]</a> <a href="#mal89">[Mal89]</a>. In general we will refer to this kind of analysis as a multiresolution analysis.</p>
<p>Summarizing, if we implement the wavelet transform as an iterated filter bank, we do not have to specify the wavelets explicitly! This sure is a remarkable result <a href="#note11">[11]</a>.</p>
<p><a name="section9"></a><a name="9-the-discrete-wavelet-transform"></a><H2>9. The discrete wavelet transform</H2></p>
<p>In many practical applications the signal of interest is sampled. In order to use the results we have achieved so far with a discrete signal we have to make our wavelet transform discrete too. Remember that our discrete wavelets are not time-discrete, only the translation- and the scale step are discrete. Simply implementing the wavelet filter bank as a digital filter bank intuitively seems to do the job. But intuitively is not good enough, we have to be sure.</p>
<p>In <a href="#eq16">(16)</a> we stated that the scaling function could be expressed in wavelets from minus infinity up to a certain scale <em>j</em>. If we add a wavelet spectrum to the scaling function spectrum we will get a new scaling function, with a spectrum twice as wide as the first. The effect of this addition is that we can express the first scaling function in terms of the second, because all the information we need to do this is contained in the second scaling function. We can express this formally in the so-called multiresolution formulation <a href="#bur98">[Bur98]</a> or <em>two-scale relation</em> <a href="#she96">[She96]</a>:</p>
<p><a name="eq18"></a><img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_964_3e36c70b64400d065c8652ff3f5e7c7c.png" style="vertical-align:-36px; display: inline-block ;" alt="varphi(2^{j}t) = sum {k}{}{h _{j+1}(k) varphi(2^{j+1}t-k)}" title="varphi(2^{j}t) = sum {k}{}{h _{j+1}(k) varphi(2^{j+1}t-k)}"/> <strong>(18)</strong></p>
<p>The two-scale relation states that the scaling function at a certain scale can be expressed in terms of translated scaling functions at the next smaller scale. Do not get confused here: smaller scale means more detail.</p>
<p>The first scaling function replaced a set of wavelets and therefore we can also express the wavelets in this set in terms of translated scaling functions at the next scale. More specifically we can write for the wavelet at level <em>j</em>:</p>
<p><a name="eq19"></a><img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_964_9d6a00fb250c1280c1f23be05ccd0d62.png" style="vertical-align:-36px; display: inline-block ;" alt="psi(2^{j}t) = sum {k}{}{g _{j+1}(k) varphi(2^{j+1}t-k)}" title="psi(2^{j}t) = sum {k}{}{g _{j+1}(k) varphi(2^{j+1}t-k)}"/> <strong>(19)</strong></p>
<p>which is the two-scale relation between the scaling function and the wavelet.</p>
<p>Since our signal <em>f</em>(<em>t</em>) could be expressed in terms of dilated and translated wavelets up to a scale <em>j</em>-1, this leads to the result that <em>f</em>(<em>t</em>) can also be expressed in terms of dilated and translated scaling functions at a scale <em>j</em>:</p>
<p><a name="eq20"></a><img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_964_087dc565b7c7d5a05dd30cfba66d997a.png" style="vertical-align:-36px; display: inline-block ;" alt="f(t) = sum {k}{}{lambda _{j}(k) varphi(2^{j}t-k)}" title="f(t) = sum {k}{}{lambda _{j}(k) varphi(2^{j}t-k)}"/> <strong>(20)</strong></p>
<p>To be consistent in our jargon we should in this case speak of discrete scaling functions since only discrete dilations and translations are allowed.</p>
<p>If in this equation we step up a scale to <em>j</em>-1 (!), we have to add wavelets in order to keep the same level of detail. We can then express the signal <em>f</em>(<em>t</em>) as
<p align="center"><a name="eq21"></a></p>
<p><a name="eq21"></a><img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_964_dd5bfe8a570438a30092e9d875413b50.png" style="vertical-align:-36px; display: inline-block ;" alt="f(t) = sum {k}{}{lambda _{j-1}(k) varphi(2^{j-1}t-k)} + sum {k}{}{gamma _{j-1}(k) psi(2^{j-1}t-k)}" title="f(t) = sum {k}{}{lambda _{j-1}(k) varphi(2^{j-1}t-k)} + sum {k}{}{gamma _{j-1}(k) psi(2^{j-1}t-k)}"/> <strong>(21)</strong></p>
<p>If the scaling function <img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_983.5_f84e518a73d153134893a6bdc68e648b.png" style="vertical-align:-16.5px; display: inline-block ;" alt="varphi _{j,k}(t)" title="varphi _{j,k}(t)"/> and the wavelets <img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_984.5_5695c9c73b90ad615d1c371a9ced7137.png" style="vertical-align:-15.5px; display: inline-block ;" alt="psi _{j,k}(t)" title="psi _{j,k}(t)"/> are orthonormal or a tight frame, then the coefficients <img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_984.5_d9ad5d594bb97bda5cc8569100469bf8.png" style="vertical-align:-15.5px; display: inline-block ;" alt="lambda _{j-1}(k)" title="lambda _{j-1}(k)"/> and <img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_983.5_59254e538379915e1ba111aa220fa550.png" style="vertical-align:-16.5px; display: inline-block ;" alt="gamma _{j-1}(k)" title="gamma _{j-1}(k)"/> are found by taking the inner products</p>
<p><a name="eq22"></a><img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_971.5_536c88ad61556b9b9bd901c9ba792485.png" style="vertical-align:-28.5px; display: inline-block ;" alt="lambda _{j-1}(k) = linprod f(t),varphi _{j,k}(t) rinprod" title="lambda _{j-1}(k) = linprod f(t),varphi _{j,k}(t) rinprod"/><br />
<img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_971.5_04459e2221e879b372516417a809bf7c.png" style="vertical-align:-28.5px; display: inline-block ;" alt="gamma _{j-1}(k) = linprod f(t),psi _{j,k}(t) rinprod" title="gamma _{j-1}(k) = linprod f(t),psi _{j,k}(t) rinprod"/> <strong>(22)</strong></p>
<p>If we now replace <img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_983.5_f84e518a73d153134893a6bdc68e648b.png" style="vertical-align:-16.5px; display: inline-block ;" alt="varphi _{j,k}(t)" title="varphi _{j,k}(t)"/> and <img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_984.5_5695c9c73b90ad615d1c371a9ced7137.png" style="vertical-align:-15.5px; display: inline-block ;" alt="psi _{j,k}(t)" title="psi _{j,k}(t)"/> in the inner products by suitably scaled and translated versions <a href="#note12">[12]</a> of <a href="#eq18">(18)</a> and <a href="#eq19">(19)</a> and manipulate a bit, keeping in mind that the inner product can also be written as an integration, we arrive at the important result <a href="#bur98">[Bur98]</a>:</p>
<p><a name="eq23"></a><img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_972_95885fce69fcd6d2360f9306fde86fe6.png" style="vertical-align:-28px; display: inline-block ;" alt="lambda _{j-1}(k) = sum {m}{}{h(m-2k) lambda _j (m)}" title="lambda _{j-1}(k) = sum {m}{}{h(m-2k) lambda _j (m)}"/><strong>(23)</strong></p>
<p><a name="eq24"></a><img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_972_950120048093ee9a09f33fe9dce73e78.png" style="vertical-align:-28px; display: inline-block ;" alt="gamma _{j-1}(k) = sum {m}{}{g(m-2k) gamma _j (m)}" title="gamma _{j-1}(k) = sum {m}{}{g(m-2k) gamma _j (m)}"/><strong>(24)</strong></p>
<p>These two equations state that the wavelet- and scaling function coefficients on a certain scale can be found by calculating a weighted sum of the scaling function coefficients from the previous scale. Now recall from the section on the scaling function that the scaling function coefficients came from a low-pass filter and recall from the section on subband coding how we iterated a filter bank by repeatedly splitting the low-pass spectrum into a low-pass and a high-pass part. The filter bank iteration started with the signal spectrum, so if we imagine that the signal spectrum is the output of a low-pass filter at the previous (imaginary) scale, then we can regard our sampled signal as the scaling function coefficients from the previous (imaginary) scale. In other words, our sampled signal <em>f</em>(<em>k</em>) is simply equal to <img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_990.5_c05e57eda93e65680cdbf42889ddc090.png" style="vertical-align:-9.5px; display: inline-block ;" alt="lambda(k)" title="lambda(k)"/> at the largest scale!</p>
<p>But there is more. As we know from signal processing theory a discrete weighted sum like the ones in <a href="#eq23">(23)</a> and <a href="#eq24">(24)</a> is the same as a digital filter and since we know that the coefficients <img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_984.5_6cf3ee8049bb0b5f331c15a653055e6a.png" style="vertical-align:-15.5px; display: inline-block ;" alt="lambda _j (k)" title="lambda _j (k)"/> come from the low-pass part of the splitted signal spectrum, the weighting factors <em>h</em>(<em>k</em>) in <a href="#eq23">(23)</a> must form a low-pass filter. And since we know that the coefficients <img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_983.5_a6f057ea344ddc3739ad338e21ab3ce4.png" style="vertical-align:-16.5px; display: inline-block ;" alt="gamma _j (k)" title="gamma _j (k)"/> come from the high-pass part of the splitted signal spectrum, the weighting factors <em>g</em>(<em>k</em>) in <a href="#eq24">(24)</a> must form a high-pass filter. This means that <a href="#eq23">(23)</a> and <a href="#eq24">(24)</a> together form one stage of an iterated digital filter bank and therefore from now on we will refer to the coefficients <em>h</em>(<em>k</em>) as the <em>scaling filter</em> and the coefficients <em>g</em>(<em>k</em>) as <em>the wavelet filter</em>.</p>
<p>By now we have made certain that implementing the wavelet transform as an iterated digital filter bank is possible and from now on we can speak of the <em>discrete wavelet transform</em> or <em>DWT</em>. Our intuition turned out to be correct. Because of this we are rewarded with a useful bonus property of <a href="#eq23">(23)</a> and <a href="#eq24">(24)</a>, the <em>subsampling property</em>. If we take one last look at these two equations we see that the scaling and wavelet filters have a step-size of 2 in the variable <em>k</em>. The effect of this is that only every other <img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_984.5_6cf3ee8049bb0b5f331c15a653055e6a.png" style="vertical-align:-15.5px; display: inline-block ;" alt="lambda _j (k)" title="lambda _j (k)"/> is used in the convolution, with the result that the output data rate is equal to the input data rate. Although this is not a new discovery, it has always been exploited in subband coding schemes, it is kind of nice to see it pop up here as part of the deal.</p>
<p>The subsampling property also solves our problem which had come up at the end of the section on the scaling function: how to choose the width of the scaling function spectrum. Because every time we iterate the filter bank, the number of samples for the next stage is halved so that in the end we are left with just one sample (in the extreme case). It will be clear that this is where the iteration definitely has to stop and this determines the width of the spectrum of the scaling function. Normally the iteration will stop at the point where the number of samples has become smaller than the length of the scaling filter or the wavelet filter, whichever is the longest, so the length of the longest filter determines the width of the spectrum of the scaling function.</p>
<p><a name="fig5"></a><div id="attachment_319" style="width: 420px" class="wp-caption alignnone"><img src="http://www.polyvalens.com/blog/wp-content/uploads/2011/07/fig3-5-gray1.png" alt="one stage of an iterated filter bank" title="fig3-5 gray" width="410" height="198" class="size-full wp-image-319" /><p class="wp-caption-text">Figure 5. Implementation of <b>(23)</b> and <b>(24)</b> as one stage of an iterated filter bank.</p></div></p>
<p><a name="section10"></a><a name="10-coda"></a><H2>10. Coda</H2></p>
<p>By now we have managed to reduce the highly redundant continuous wavelet transform as formulated in <a href="#eq1">(1)</a> with its infinite number of unspecified wavelets to a finite stage iterated digital filter bank which can be directly implemented on a digital computer. The redundancy has been removed by using discrete wavelets and a scaling function solved the problem of the infinite number of wavelets needed in the wavelet transform. The filter bank has solved the problem of the non-existence of analytical solutions as mentioned in the section on discrete wavelets. Finally, we have built a digitally implementable version of <a href="#eq1">(1)</a> without specifying <em>any</em> wavelet, just as in <a href="#eq1">(1)</a>. The wavelet transform has become very practical indeed.</p>
<p><a name="fig6"></a><div id="attachment_325" style="width: 529px" class="wp-caption alignnone"><img src="http://www.polyvalens.com/blog/wp-content/uploads/2011/07/fig3-6-gray.png" alt="some scaling functions and wavelets" title="fig3-6 gray" width="519" height="353" class="size-full wp-image-325" /><p class="wp-caption-text">Figure 6. Some scaling functions (left) and wavelets (rigth) from the biorthogonal Deslauriers-Dubuc family (like humans wavelets live in families, but there are also species that live in packs). From left to right: (2,2), (4,2), (6,2), (2,4) and (4,4). The first number is the number of vanishing moments of the analyzing wavelet (the wavelet that decomposes a signal) and the second number is the number of vanishing moments of the synthesizing wavelet (the wavelet that reconstructs the signal). Note that with increasing number of vanishing moments (wavelets a, b and c) the wavelet becomes smoother or more regular. The same is true for the scaling function. Note also that the shape of these wavelets is not the rule. Although there are many wavelets that look like this, there are also many wavelets that look completely different. The wavelets shown here are just easy to create.</p></div></p>
<p><a name="refs"></a><a name="11-notes"></a><H2>11. Notes</H2></p>
<p><a name="note1"></a><strong>[1]</strong> This in contrast to <a href="#kai94">[Kai94]</a>.</p>
<p><a name="note2"></a><strong>[2]</strong> A Kronecker delta is defined as <em>f</em> (<em>t</em>) = 1 at <em>t</em>=0 and <em>f</em> (<em>t</em>) = 0 for all other <em>t</em>.</p>
<p><a name="note3"></a><strong>[3]</strong> &#8220;<em>I am serious, and don&#8217;t call me Shirley.</em>&#8221; Leslie Nielsen as Dr. Rumack in the film Airplane! (1980).</p>
<p><a name="note4"></a><strong>[4]</strong> There exist functions of which all moments vanish. An example is the function</p>
<p><img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_982_9531721f7f13d2b6ada2a954cb4d882a.png" style="vertical-align:-18px; display: inline-block ;" alt="e^{-x^{1/4}} sin(x^4)" title="e^{-x^{1/4}} sin(x^4)"/></p>
<p>for x&ge;0 <a href="#kor96">[Kör96]</a></p>
<p><a name="note5"></a><strong>[5]</strong> The term regularity seems to stem from the definition that a filter is called K-regular if its z-transform has K zeroes at <img src="http://www.polyvalens.com/blog/wp-content/plugins/wpmathpub/phpmathpublisher/img/math_993_5557c1226a91340b732106addc7621b0.png" style="vertical-align:-7px; display: inline-block ;" alt="z = e^{i pi}" title="z = e^{i pi}"/>. In wavelet theory this applies to the scaling filter (which has not been mentioned yet) and it is possible only if all wavelet moments up to K-1 vanish <a href="#bur98">[Bur98]</a>. The scaling filter is formed by the coefficients h(k) in <a href="#eq17">(17)</a>.</p>
<p><a name="note6"></a><strong>[6]</strong> The CWT behaves just like an orthogonal transform in the sense that the inverse wavelet transform permits us to reconstruct the signal by an integration of all the projections of the signal onto the wavelet basis. This is called quasi-orthogonality <a href="#she96">[She96]</a>.</p>
<p><a name="note7"></a><strong>[7]</strong> Note that this introduction of the scaling function differs from the usual introduction through multiresolution analysis. I hope that by doing it this way it will keep the story gripping.</p>
<p><a name="note8"></a><strong>[8]</strong> When you want to go from A to B you first have to travel half the distance. But before you reach this half-way point you have to travel half of half the distance. But before you reach this quarter-way point you have to travel half of half of half the distance, etc.. In other words, you will never arrive in B because you have to travel to an infinite number of half-way points. This is the famous dichotomy paradox by Zeno of Elea (approx. 490-430 BC).</p>
<p><a name="note9"></a><strong>[9]</strong> If the degrees of freedom in a wavelet transform design are not only used on creating vanishing moments for the wavelet, but are equally distributed among the scaling function and the wavelet to create vanishing moments for both functions, we speak of Coiflets. Coiflets are more symmetric than the wavelet transforms known before their introduction (1989). They are named after their inventor Coifman <a href="#tia96">[Tia96]</a>.</p>
<p><a name="note10"></a><strong>[10]</strong> Subband coding is not restricted to constant-Q filter banks.</p>
<p><a name="note11"></a><strong>[11]</strong> Since it is possible to implement a wavelet transform without explicitly implementing wavelets, it might be a good idea not to use the term wavelet transform at all and just call it subband coding. But then again, the Fourier transform can be implemented without explicitly implementing Fouriers, so why bother?</p>
<p><a name="note12"></a> <strong>[12]</strong> To scale and translate suitably, replace 2<em><sup>j</sup>t</em> in <a href="#eq18">(18)</a> and <a href="#eq19">(19)</a> by 2<em><sup>j</sup>t-k</em>.</p>
<p><a name="refs"></a><a name="12-references"></a><H2>12. References</H2></p>
<p><strong>Books and papers</strong></p>
<p><a name="bur98"></a>[Bur98] <strong>Burrus</strong>, C. S. and R. A. <strong>Gopinath</strong>, H. <strong>Guo</strong>. <em>INTRODUCTION TO WAVELETS AND WAVELET TRANSFORMS, A PRIMER.</em> Upper Saddle River, NJ (USA): Prentice Hall, 1998.</p>
<p><a name="cal96"></a>[Cal96] <strong>Calderbank</strong>, A. R. and I. <strong>Daubechies</strong>, W. <strong>Sweldens</strong>, B.-L. <strong>Yeo</strong> <em>WAVELET TRANSFORMS THAT MAP INTEGERS TO INTEGERS.</em> Proceedings of the IEEE Conference on Image Processing. Preprint, 1996. IEEE Press, 1997.</p>
<p><a name="dau92"></a>[Dau92] <strong>Daubechies</strong>, I. <em>TEN LECTURES ON WAVELETS. 2nd ed.</em> Philadelphia: SIAM, 1992. CBMS-NSF regional conference series in applied mathematics 61.</p>
<p><a name="hub96"></a>[Hub96] <strong>Hubbard</strong>, B. Burke <em>THE WORLD ACCORDING TO WAVELETS.</em> Wellesey, MA (USA): A K Peters, 1996.</p>
<p><a name="kai94"></a>[Kai94] <strong>Kaiser</strong>, G. <em>A FRIENDLY GUIDE TO WAVELETS.</em> Boston: Birkhäuser, 1994.</p>
<p><a name="kor96"></a>[Kör96] <strong>Körner</strong>, T. W. <em>FOURIER ANALYSIS.</em> Cambridge, UK: Cambridge University Press, 1996.</p>
<p><a name="mal89"></a>[Mal89] <strong>Mallat</strong>, S. G. <em>A THEORY FOR MULTIRESOLUTION SIGNAL DECOMPOSITION: THE WAVELET REPRESENTATION.</em> IEEE Transactions on Pattern Analysis and Machine Intelligence, Vol. 11, No. 7 (1989), p. 674-693.</p>
<p><a name="she96"></a>[She96] <strong>Sheng</strong>, Y. <em>WAVELET TRANSFORM.</em> In: The transforms and applications handbook. Ed. by A. D. Poularikas. P. 747-827. Boca Raton, Fl (USA): CRC Press, 1996. The Electrical Engineering Handbook Series.</p>
<p><a name="vet92"></a>[Vet92] <strong>Vetterli </strong>M. and C. <strong>Herley</strong>. <em>WAVELETS AND FILTER BANKS: THEORY AND DESIGN.</em> IEEE Transactions on Signal Processing, Vol. 40, No. 9 (1992), p. 2207-2232.</p>
<p><a name="wei94"></a>[Wei94] <strong>Weiss</strong>, L. G. <em>WAVELETS AND WIDEBAND CORRELATION PROCESSING.</em> IEEE Signal Processing Magazine, January (1994), p. 13-32.</p>
<p><strong>Internet resources</strong></p>
<p>Besides traditional references (i.e. on paper) there are many Internet resources that deal with wavelets. Here I list a few that have proved to be useful. With these links probably every other wavelet related site can be found. Keep in mind however that this list was verified for the last time in October 2010.</p>
<p><a href="http://www.wavelet.org/wavelet/index.html">The Wavelet Digest</a>, a monthly electronic magazine currently edited by Wim Sweldens, is a platform for people working with wavelets. It contains announcements of conferences, abstracts of publications and preprints and questions and answers of readers. It can be found at and it is <strong>the</strong> site for wavelets.</p>
<p><a href="http://www-dsp.rice.edu/publications/">Rice University</a>, the home of Burrus <a href="#bur98">[Bur98]</a> et al, keeps a list of publications and makes available the Rice Wavelet Toolbox for MatLab.</p>
<p><a href="http://www.cs.kuleuven.ac.be/~wavelets/">The Katholieke Universiteit of Leuven</a>, Belgium, is active on the net with wavelets, publications and the toolbox WAILI.</p>
<p><a href="http://www.amara.com/current/wavelet.html">Amara Graps</a> maintains a long list of links, publications and tools besides explaining wavelet theory in a nutshell.</p>
<p>There used to be a real lifting page, dedicated to <a href="http://www.cs.sc.edu/~fernande/liftpack/index.html">Liftpack</a>, a lifting toolbox. Unfortunately, it is no longer available but recently I found a copy on an old hard disk. <a href="../download/liftpack-1_0-cc_tar.gz">Download it here.</a></p>
<div class="clear-cols"></div>		    </div><!-- .entry-content -->
	    </div><!-- #post-15 -->

			<div id="comments">


	<p class="nocomments">Comments are closed.</p>


		
</div><!-- #comments -->
	</div><!-- #content -->
	</div><!-- #container altright -->
    </div>
    </div><!-- #main -->
    	<div id="footer">
		<div id="colophon">

<table id='ttw_ftable'><tr>
 <td id='ttw_ftdl'><div id="site-info">
 &copy; 2014 - <a href="http://www.polyvalens.com/blog/" title="PolyValens" rel="home">PolyValens</a>
 </div></td>  <td id='ttw_ftdr'><div id="site-generator">
  <a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">Proudly powered by WordPress.</a>
 Weaver by WeaverTheme.com
 </div></td> </tr></table>
		</div><!-- #colophon -->
	</div><!-- #footer -->
    </div><!-- #wrapper -->


<script type='text/javascript' src='http://www.polyvalens.com/blog/wp-includes/js/jquery/jquery.js?ver=1.10.2'></script>
<script type='text/javascript' src='http://www.polyvalens.com/blog/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.2.1'></script>
<script>var pltNewTabURLs = ["http:\/\/www.polyvalens.com\/book"];(function(){jQuery(function(e){return e("body").on("click","a",function(t){var n;n=e(this);if(e.inArray(n.attr("href"),pltNewTabURLs)>-1)return n.attr("target","_blank")})})}).call(this);</script></body>
</html>
